<?xml version="1.0" encoding="utf-8" ?>
<nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      autoReload="true"
      internalLogLevel="Trace"
      internalLogFile="internal-nlog.txt">

	<targets>
		<target xsi:type="File" name="filelog" fileName="logs/log-${shortdate}.txt"
				layout="${longdate} ${level} ${message} ${exception}" />

		<target xsi:type="Database" name="dblog"
				connectionString="Server=DESKTOP-CHEOOOO\SQLEXPRESS;Database=TelefonRehberi;Trusted_Connection=True;TrustServerCertificate=True;"
				dbProvider="System.Data.SqlClient">
			<commandText>
				INSERT INTO Logs (KullaniciId, Islem, Tarih, Detay)
				VALUES (@kullaniciId, @islem, GETDATE(), @detay);
			</commandText>
			<parameter name="@kullaniciId" layout="${event-properties:item=KullaniciId}" />
			<parameter name="@islem" layout="${event-properties:item=Islem}" />
			<parameter name="@detay" layout="${message}" />
		</target>
	</targets>

	<rules>
		<logger name="TelefonRehberi.Controllers.*" minlevel="Info" writeTo="filelog,dblog" />
	</rules>
</nlog>
